# 插值算法

插值算法是一种用于构建通过给定数据点的函数的数学方法。通过插值，我们可以在已知数据点之间估计未知的函数值。插值在数值分析、计算机图形学、工程和科学计算等领域都有广泛应用。

<!-- toc -->

## 1. 插值算法的基本概念

插值的基本思想是利用已知数据点（称为节点或插值点）来构造一个新的函数，使得这个函数在这些节点上能够精确地通过这些已知值。插值函数的类型和形式可以根据具体需求进行选择。

### 1.1 插值的目的

- **数据平滑**：通过插值可以在数据点之间创建平滑的曲线。
- **函数估计**：在已知数据点的基础上估计其他点的值。
- **数值计算**：在数值计算中，插值可以用于函数的逼近和数值积分等。

## 2. 常见的插值方法

### 2.1 分段线性插值法

**定义**：分段线性插值法是最简单的插值方法之一，它通过连接相邻的点来形成线性段，从而在每对相邻点之间进行线性插值。

**公式**：
对于已知点 $(x_0, y_0)$ 和 $(x_1, y_1)$，在区间 $[x_0, x_1]$ 内，插值函数为：
$$
y = y_0 + \frac{(y_1 - y_0)}{(x_1 - x_0)}(x - x_0)
$$

**优缺点**：
- **优点**：简单易懂，计算量小。
- **缺点**：在数据变化剧烈时，可能导致插值结果不够平滑。

### 2.2 拉格朗日插值法

**定义**：拉格朗日插值法通过构造拉格朗日基函数来实现插值。给定 $n+1$ 个数据点 $(x_i, y_i)$，拉格朗日插值多项式为：
$$
P(x) = \sum_{i=0}^{n} y_i L_i(x)
$$
其中，$L_i(x)$ 为拉格朗日基函数：
$$
L_i(x) = \prod_{j=0, j \neq i}^{n} \frac{x - x_j}{x_i - x_j}
$$

**优缺点**：
- **优点**：能够精确通过所有的插值点。
- **缺点**：计算复杂度高，尤其是节点较多时，容易产生数值不稳定性。

### 2.3 牛顿插值法

**定义**：牛顿插值法通过构造牛顿插值多项式来实现插值，使用差商来提高计算效率。给定 $n+1$ 个数据点，牛顿插值多项式为：
$$
P(x) = f[x_0] + (x - x_0)f[x_0, x_1] + (x - x_0)(x - x_1)f[x_0, x_1, x_2] + \ldots
$$
其中，$f[x_i, x_j]$ 是差商。

**优缺点**：
- **优点**：可以方便地添加新的插值点，计算效率高。
- **缺点**：在节点较多时，可能出现数值不稳定性。

### 2.4 埃尔米特插值法

**定义**：埃尔米特插值法不仅考虑插值点的函数值，还考虑导数值，适用于需要保持导数连续性的情况。给定 $n+1$ 个点及其导数值，埃尔米特插值多项式为：
$$
P(x) = \sum_{i=0}^{n} \left( y_i H_i(x) + f'(x_i) H_i'(x) \right)
$$
其中，$H_i(x)$ 是埃尔米特基函数。

**优缺点**：
- **优点**：能够保证插值函数在插值点的导数连续。
- **缺点**：计算复杂度较高。

MATLAB中分段三次埃尔米特插值法：`p = pchip(x, y, new_x)`
### 2.5 样条插值法

**定义**：样条插值法使用低阶多项式（通常是三次多项式）在每个插值区间内进行插值，确保在节点处的连续性和光滑性。常用的有线性样条、二次样条和三次样条。

### 2.6 三次样条插值法

**定义**：三次样条插值法是最常用的样条插值方法。它通过在每个区间内使用三次多项式，并确保在每个节点处的函数值、导数值和二阶导数值连续。

**公式**：
对于每个区间 $[x_i, x_{i+1}]$，三次样条多项式为：
$$
S_i(x) = a_i + b_i (x - x_i) + c_i (x - x_i)^2 + d_i (x - x_i)^3
$$

**优缺点**：
- **优点**：平滑性好，计算效率高，适用于大多数插值问题。
- **缺点**：在节点数目较多时，计算和存储开销增加。

MATLAB中三次样条插值法：`p = spline(x, y, new_x)`


## 3. 龙格现象

**定义**：龙格现象是指在使用高次多项式插值时，尤其是拉格朗日插值法，在插值节点外部出现剧烈震荡的现象。这种现象通常发生在节点分布不均匀时，尤其是在边界处。

**解决方法**：
- 降低多项式的次数。
- 使用分段插值（如样条插值）。
- 选择更均匀的节点分布。

## 4. 总结

插值算法是一项重要的数值分析技术，能够在一组已知数据点之间构建平滑的函数。不同的插值方法各有优缺点，适用于不同的应用场景。在实际应用中，选择合适的插值方法可以有效提高计算的准确性和效率。
